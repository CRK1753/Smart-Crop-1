<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Community & Vendors Chat</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<style>
:root{ --green:#2f8f4a; --light:#e6f3ea; }

body{
  background:var(--light);
  font-family:system-ui,sans-serif;
  padding-bottom:60px;
  margin:0;
}

/* SEARCH BAR */
.search-bar{
  position:fixed;
  top:0; left:0; right:0;
  padding:12px 16px;
  z-index:1000;
  background:var(--light);
}
.search-bar input{
  width:100%;
  padding:10px 14px;
  border-radius:20px;
  border:none;
  outline:none;
  font-size:15px;
}

/* TABS */
.tabs{
  display:flex;
  justify-content:space-around;
  margin-top:60px;
  background:#f7f7f7;
  position:fixed;
  top:0.1px; left:0; right:0;
  z-index:999;
  border-bottom:1px solid #ccc;
}
.tabs button{
  flex:1;
  padding:10px 0;
  border:none;
  background:none;
  font-weight:600;
  font-size:15px;
  cursor:pointer;
}
.tabs button.active{
  border-bottom:3px solid var(--green);
  color:var(--green);
}

/* CHAT LIST â€“ WhatsApp/Telegram style */
.chat-list{
  margin-top:110px; /* search + tabs height */
}
.chat-item{
  display:flex;
  align-items:center;
  padding:10px 16px;
  background:#fff;
  border-bottom:1px solid #eee;
  cursor:pointer;
  transition:background 0.2s;
}
.chat-item:hover{ background:#f9f9f9; }
.chat-avatar{
  width:48px; height:48px;
  border-radius:50%;
  margin-right:12px;
  flex-shrink:0;
  object-fit:cover;
}
.chat-info{
  flex:1;
  min-width:0; /* text ellipsis */
}
.chat-title{
  font-weight:600;
  font-size:15px;
  margin:0;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.chat-preview{
  color:#666;
  font-size:13px;
  margin:0;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.chat-time{
  font-size:11px;
  color:#999;
  margin-left:8px;
}

/* CHAT VIEW */
.chat-view{
  display:none;
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  background:var(--light);
  z-index:2000;
  flex-direction:column;
}
.chat-header{
  background:var(--green);
  color:#fff;
  padding:12px;
  display:flex;
  align-items:center;
}
.chat-header button{
  background:none;
  border:none;
  color:white;
  font-size:20px;
}
.chat-header h6{flex:1;text-align:center;margin:0;}
.chat-messages{
  flex:1;
  overflow-y:auto;
  padding:16px;
}
.message{
  background:#fff;
  border-radius:12px;
  padding:10px 14px;
  margin-bottom:12px;
  max-width:80%;
  box-shadow:0 3px 8px rgba(0,0,0,0.05);
  white-space:pre-line;
}
.message.user{
  background:var(--green);
  color:white;
  margin-left:auto;
}
.message.pinned{
  background:#ffeeba;
  color:#856404;
  font-weight:600;
}
.message img{
  max-width:100%;
  border-radius:10px;
  margin-top:6px;
}

/* INPUT AREA */
.chat-input{
  background:var(--green);
  padding:10px 12px;
  display:flex;
  align-items:center;
  gap:8px;
}
.chat-input input{
  flex:1;
  border:none;
  border-radius:20px;
  padding:8px 12px;
  outline:none;
}
.chat-input button{
  background:#1e6d34;
  color:white;
  border:none;
  border-radius:50%;
  width:40px;
  height:40px;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* BOTTOM NAV */
.bottom-nav{
  position:fixed;
  left:0;right:0;bottom:0;
  height:50px;
  background:var(--green);
  display:flex;
  justify-content:space-around;
  align-items:center;
  color:white;
  border-top-left-radius:12px;
  border-top-right-radius:12px;
  z-index:1000;
}
.bottom-nav a{
  color:white;
  text-decoration:none;
  text-align:center;
  font-size:13px;
}
.bottom-nav .bi{font-size:16px;}
</style>
</head>
<body>

<!-- SEARCH BAR -->
<div class="search-bar">
  <input type="text" id="searchInput" placeholder="Search users, groups or vendors...">
</div>

<!-- TABS -->
<div class="tabs">
  <button class="active" id="communityTab">Community</button>
  <button id="vendorsTab">Vendors</button>
</div>

<!-- COMMUNITY LIST -->
<div id="communityList" class="chat-list">
  <div class="chat-item" data-name="Agri Farmers Hub" data-type="community">
    <img class="chat-avatar" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/Plant_icon.png/60px-Plant_icon.png" alt="Group">
    <div class="chat-info">
      <p class="chat-title">Agri Farmers Hub</p>
      <p class="chat-preview">ðŸ“ˆ Market update: Rice â‚¹45/kg, Maize â‚¹30/kg...</p>
    </div>
    <span class="chat-time">9:45 AM</span>
  </div>

  <div class="chat-item" data-name="Vegetable Growers" data-type="community">
    <img class="chat-avatar" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/Plant_icon.png/60px-Plant_icon.png" alt="Group">
    <div class="chat-info">
      <p class="chat-title">Vegetable Growers</p>
      <p class="chat-preview">Hello vegetable growers!</p>
    </div>
    <span class="chat-time">Yesterday</span>
  </div>
</div>

<!-- VENDOR LIST -->
<div id="vendorList" class="chat-list" style="display:none">
  <div class="chat-item" data-name="Local Seed Supplier" data-type="vendor">
    <img class="chat-avatar" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/32/Seed_icon.png/60px-Seed_icon.png" alt="Vendor">
    <div class="chat-info">
      <p class="chat-title">Local Seed Supplier</p>
      <p class="chat-preview">Available seeds for wheat, maize, and rice.</p>
    </div>
    <span class="chat-time">8:10 AM</span>
  </div>

  <div class="chat-item" data-name="Fertilizer Co" data-type="vendor">
    <img class="chat-avatar" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Fertilizer_icon.png/60px-Fertilizer_icon.png" alt="Vendor">
    <div class="chat-info">
      <p class="chat-title">Fertilizer Co</p>
      <p class="chat-preview">New fertilizer discounts this week!</p>
    </div>
    <span class="chat-time">Mon</span>
  </div>
</div>

<!-- CHAT VIEW -->
<div class="chat-view" id="chatView">
  <div class="chat-header">
    <button id="backBtn"><i class="bi bi-arrow-left"></i></button>
    <h6 id="chatTitle">Chat</h6>
  </div>
  <div class="chat-messages" id="chatMessages"></div>
  <div class="chat-input">
    <input type="text" id="msgInput" placeholder="Type a message...">
    <button id="sendMsg"><i class="bi bi-send-fill"></i></button>
  </div>
</div>

<!-- BOTTOM NAVIGATION -->
<div class="bottom-nav">
  <a href="index.html"><i class="bi bi-house-door-fill"></i><br>Home</a>
  <a href="search.html"><i class="bi bi-search"></i><br>Search</a>
  <a href="community.html"><i class="bi bi-people-fill"></i><br>Community</a>
  <a href="profile.html"><i class="bi bi-person-circle"></i><br>Profile</a>
</div>

<script>
const communityTab = document.getElementById('communityTab');
const vendorsTab = document.getElementById('vendorsTab');
const communityList = document.getElementById('communityList');
const vendorList = document.getElementById('vendorList');

communityTab.onclick = () => {
  communityTab.classList.add('active');
  vendorsTab.classList.remove('active');
  communityList.style.display='block';
  vendorList.style.display='none';
};
vendorsTab.onclick = () => {
  vendorsTab.classList.add('active');
  communityTab.classList.remove('active');
  communityList.style.display='none';
  vendorList.style.display='block';
};

// Chat view logic
const chatView = document.getElementById('chatView');
const backBtn = document.getElementById('backBtn');
const chatTitle = document.getElementById('chatTitle');
const chatMessages = document.getElementById('chatMessages');
const msgInput = document.getElementById('msgInput');
const sendMsg = document.getElementById('sendMsg');

const sampleChats = {
  'Agri Farmers Hub': [
    {sender:'pinned', text:"ðŸ“ˆ Market update: Rice â‚¹45/kg, Maize â‚¹30/kg, Pulses â‚¹70/kg"},
    {sender:'Admin', text:"Welcome everyone! ðŸŒ¾"},
    {sender:'Ravi', text:"Rain forecast next week will help our paddy fields."}
  ],
  'Vegetable Growers': [
    {sender:'pinned', text:"ðŸ“ˆ Market update: Tomato â‚¹25/kg, Cucumber â‚¹15/kg"},
    {sender:'Admin', text:"Hello vegetable growers!"},
    {sender:'Sita', text:"Need advice on pest control for cucumbers."}
  ],
  'Local Seed Supplier': [
    {sender:'Supplier', text:"Available seeds for wheat, maize, and rice."}
  ],
  'Fertilizer Co': [
    {sender:'Fertilizer', text:"New fertilizer discounts this week!"}
  ]
};

function openChat(name){
  chatView.style.display='flex';
  chatTitle.textContent=name;
  chatMessages.innerHTML='';
  document.body.style.overflow='hidden';
  if(sampleChats[name]){
    sampleChats[name].forEach(m=>{
      const div=document.createElement('div');
      div.className='message' + (m.sender==='pinned'?' pinned':'');
      div.textContent=m.text;
      chatMessages.appendChild(div);
    });
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }
}

backBtn.onclick = ()=>{
  chatView.style.display='none';
  document.body.style.overflow='auto';
};

function addMessage(text){
  const div=document.createElement('div');
  div.className='message user';
  div.textContent=text;
  chatMessages.appendChild(div);
  chatMessages.scrollTop=chatMessages.scrollHeight;
}

sendMsg.onclick = ()=>{
  const text=msgInput.value.trim();
  if(!text) return;
  addMessage(text);
  msgInput.value='';
};

msgInput.addEventListener('keydown', e=>{
  if(e.key==='Enter'){
    e.preventDefault();
    sendMsg.click();
  }
});

document.querySelectorAll('.chat-item').forEach(item=>{
  item.onclick = ()=> openChat(item.dataset.name);
});
</script>
</body>
</html>
