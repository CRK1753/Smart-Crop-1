<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Sign Up</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<style>
body{background:#e6f3ea;font-family:system-ui;padding:20px;}
.card{max-width:420px;margin:auto;}
.eye-toggle{
  cursor:pointer;
  display:flex;
  align-items:center;
  padding:0 10px;
  font-size:20px;
  color:#555;
}
</style>
</head>
<body>

<div class="card p-4 shadow">
  <h3 class="text-success text-center mb-3">Sign Up</h3>

  <form id="signupForm">
    <input type="text" class="form-control mb-3" id="name" placeholder="Full Name" required>

    <div class="input-group mb-3">
      <span class="input-group-text">+91</span>
      <input type="tel" class="form-control" id="mobile" placeholder="Mobile Number"
             pattern="[6-9]{1}[0-9]{9}" required>
    </div>

    <input type="email" class="form-control mb-3" id="email" placeholder="Email" required>

    <!-- Password with Eye -->
    <div class="input-group mb-3">
      <input type="password" class="form-control" id="password" placeholder="Password" required>
      <span class="input-group-text eye-toggle" id="togglePassword">
        <i class="bi bi-eye"></i>
      </span>
    </div>

    <select id="state" class="form-select mb-3" required>
      <option value="">Select State</option>
    </select>

    <select id="district" class="form-select mb-3" required>
      <option value="">Select District</option>
    </select>

    <input type="text" class="form-control mb-3" id="aadhar" placeholder="Aadhar Number"
           pattern="[0-9]{12}" required>

    <!-- Captcha -->
    <div class="mb-3">
      <label class="form-label">Captcha</label>
      <div class="d-flex">
        <input type="text" id="captchaInput" class="form-control me-2" placeholder="Enter Captcha" required>
        <span id="captchaText" class="border p-2 bg-light"></span>
        <button type="button" class="btn btn-outline-secondary ms-2" id="refreshCaptcha">â†»</button>
      </div>
    </div>

    <!-- OTP Verification Method -->
    <div class="mb-3">
      <label class="form-label">Verify using</label>
      <select id="verifyMethod" class="form-select">
        <option value="phone">Phone OTP</option>
        <option value="email">Email OTP</option>
      </select>
    </div>

    <button class="btn btn-success w-100">Sign Up</button>
  </form>

  <p class="text-center mt-3">Already have an account? <a href="login.html">Sign In</a></p>
</div>

<script>
const stateSel = document.getElementById('state');
const districtSel = document.getElementById('district');
const captchaText = document.getElementById('captchaText');
const refreshCaptcha = document.getElementById('refreshCaptcha');
const signupForm = document.getElementById('signupForm');
const passwordField = document.getElementById('password');
const togglePassword = document.getElementById('togglePassword');

let indiaData = {};
let captchaCode = "";

// Generate captcha
function newCaptcha(){
  captchaCode = Math.random().toString(36).substring(2,7).toUpperCase();
  captchaText.textContent = captchaCode;
}
newCaptcha();
refreshCaptcha.onclick = newCaptcha;

// Toggle password visibility
togglePassword.addEventListener('click', () => {
  const icon = togglePassword.querySelector('i');
  if (passwordField.type === "password") {
    passwordField.type = "text";
    icon.classList.remove('bi-eye');
    icon.classList.add('bi-eye-slash');
  } else {
    passwordField.type = "password";
    icon.classList.remove('bi-eye-slash');
    icon.classList.add('bi-eye');
  }
});

// Load state/district JSON
fetch('india_states_districts.json')
  .then(res => res.json())
  .then(data => {
    indiaData = data;
    const states = [...new Set(data.districts.map(d => d.state))].sort();
    states.forEach(st => stateSel.add(new Option(st, st)));
  });

stateSel.onchange = () => {
  districtSel.length = 1;
  const selected = stateSel.value;
  const districts = indiaData.districts
    .filter(item => item.state === selected)
    .map(item => item.district)
    .sort();
  districts.forEach(d => districtSel.add(new Option(d,d)));
};

// Handle signup
signupForm.onsubmit = e => {
  e.preventDefault();
  if (document.getElementById('captchaInput').value.trim().toUpperCase() !== captchaCode){
    newCaptcha();
    return;
  }

  // Store minimal user info for demo login
  localStorage.setItem('user', JSON.stringify({
    email: document.getElementById('email').value.trim(),
    mobile: document.getElementById('mobile').value.trim(),
    password: passwordField.value
  }));

  // Direct to home page
  window.location.href = "index.html";
};
</script>
</body>
</html>
